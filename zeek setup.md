# Zeek & Suricata Integration with Splunk (SOC Lab)

## Overview
In this SOC Lab, Zeek and Suricata were deployed on the SOC01 Ubuntu server (which also runs Splunk Enterprise). Instead of using a Splunk Universal Forwarder, Splunk was configured to locally monitor the log files generated by both tools. This allowed for direct ingestion of JSON logs into Splunk indexes for security monitoring and analysis.

## Zeek Setup
Enabled JSON logs by updating `local.zeek`:
sudo bash -c 'echo "redef LogAscii::use_json = T;" >> /opt/zeek/share/zeek/site/local.zeek'

Applied config and started Zeek:
sudo /opt/zeek/bin/zeekctl check
sudo /opt/zeek/bin/zeekctl deploy

Verified logs:
ls -l /opt/zeek/logs/current/

## Suricata Setup
Verified EVE JSON logs:
sudo tail -n 5 /var/log/suricata/eve.json

## Splunk Configuration
Created indexes:
sudo /opt/splunk/bin/splunk add index zeek
sudo /opt/splunk/bin/splunk add index suricata

Configured local inputs by editing `/opt/splunk/etc/system/local/inputs.conf`:
[default]
host = SOC01

[monitor:///opt/zeek/logs/current]
disabled = false
index = zeek
sourcetype = zeek:json
whitelist = \.log$

[monitor:///var/log/suricata/eve.json]
disabled = false
index = suricata
sourcetype = suricata:json

Restarted Splunk:
sudo /opt/splunk/bin/splunk restart

## Verification in Splunk
Confirmed Zeek logs:
index=zeek | stats count by sourcetype

Confirmed Suricata logs:
index=suricata | stats count by event_type

## Notes
- No Splunk Forwarder was used; Splunk Enterprise directly monitored log files.
## Screenshots

<img width="374" height="281" alt="zeek and suricata logs" src="https://github.com/user-attachments/assets/91b66f1d-169b-46b3-917e-6f5e8f9eea8e" />



